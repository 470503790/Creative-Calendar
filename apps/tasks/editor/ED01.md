# ED01 — 编辑器架构重构：Scene/Renderer/Command 分层

> **阶段**：前端（uni-app · Vue3 + TS · mp-weixin） · **数据**：Mock  
> **路径适配**：所有实现均位于 `apps/miniapp/pages/editor/**` 下。

## 目标（Goal）
- 拆分 Scene（数据）、Renderer（渲染）、Command（命令/撤销），并接线到页面入口。

## 修改范围（Scope）
- 新增/完善：`apps/miniapp/pages/editor/core/{scene.ts,renderer.ts,commands.ts,register.ts}`、`apps/miniapp/pages/editor/utils/{geometry.ts}`；页面入口 `apps/miniapp/pages/editor/index.vue` 仅负责挂载。

## 实施步骤（How to）
1) 设计 `Scene` 类型（Project/Page/Layer）。
2) `Renderer` 输入 `Scene + viewport`，暴露 `render()/hitTest()/getBounds()`。
3) `CommandBus`：`execute/undo/redo`；覆盖 add/update/remove/reorder/group。 
4) 在 `index.vue` 注入 Renderer，渲染空场景。

## 验收标准（Definition of Done）
- [ ] 文件落位无循环依赖；空场景渲染
- [ ] add/update/reorder 可撤销/重做（100 步）
- [ ] `pnpm lint`、`pnpm typecheck` 通过

## 测试方案（Testing）
- Vitest（若有）：命令撤销/重做
- 手测：新增→撤销→重做链路

## 风险与回滚（Risks & Rollback）
- 迁移期 break change → 添加适配层逐步替换

## 估时与负责人（Estimate & Owner）
- 估时：1.5d
- 负责人：@待指派
