# ED02 — 画布渲染与视口：dpi 缩放、平移/缩放手势、坐标系

> **阶段**：前端（uni-app · Vue3 + TS · mp-weixin） · **数据**：Mock  
> **规范**：结合《创意日历 App 全套界面与产品规范 V1》（画布最新版）

## 目标（Goal）
- 设备像素比清晰渲染；世界↔屏幕坐标转换；双指缩放/拖拽平移/双击居中。

## 修改范围（Scope）
- `renderer.ts:setViewport()`；`components/editor/Canvas.vue` 封装事件

## 实施步骤（How to）
1) DPR 处理：`canvas.width = cssWidth * dpr` 且 `ctx.scale(dpr*scale, dpr*scale)`。
2) 视口：`scale(0.1-4) / tx / ty`；提供 `worldToScreen/screenToWorld`。
3) 手势：双指缩放（锚点=手势中心）、拖拽平移、双击居中选区。
4) `requestAnimationFrame` 批量刷新，移动事件节流。

## 验收标准（Definition of Done）
- [ ] 任意分辨率下清晰不糊
- [ ] 缩放/平移体验流畅
- [ ] 100 layer ≥40fps（模拟）

## 测试方案（Testing）
- 单测：坐标换算数学正确
- 真机：低端与主流各 1 台

## 风险与回滚（Risks & Rollback）
- 小程序 canvas 差异 → 使用 `type="2d"` 标准接口

## 估时与负责人（Estimate & Owner）
- 估时：1d
- 负责人：@待指派
