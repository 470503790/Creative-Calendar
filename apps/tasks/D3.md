# D3 — 全局状态标准化（Pinia Stores & 类型）

> **阶段**：前端优先（uni-app, Vue3 + TS, mp-weixin） · **数据**：Mock  
> **规范**：参考《创意日历 App 全套界面与产品规范 V1》（最新）

## 目标（Goal）
- 统一 `templates/editor/projects/exports/prefs` 五个 store 的 **类型、命名、持久化策略**。

## 修改范围（Scope）
- `stores/*` 与 `types/*.d.ts`
- `plugins/persist.ts`（本地存储插件）

## 输入与依赖（Inputs & Dependencies）
- 输入：现有各页面用到的状态与字段
- 依赖：R1~R6 任一完成后开始

## 输出（Deliverables）
- `types/` 导出类型；`stores/` 统一命名与方法签名；持久化插件接入

## 实施步骤（How to）
1. 在 `types/` 定义核心类型（Template/TemplateDetail/Project/ExportRecord/Prefs）。
2. 重构 stores：统一 `getById/list/create/update/remove` 等方法签名。
3. `persist` 插件：部分 store 持久化（如 `projects/prefs`），敏感/大对象（`editor.scene`）按需压缩。

## 验收标准（Definition of Done）
- [ ] 所有 store 类型通过 `vue-tsc`
- [ ] 刷新后数据一致；无循环依赖

## 测试方案（Testing）
- Store 的 CRUD 单测

## 风险与回滚（Risks & Rollback）
- 破坏兼容 → 按模块分 PR 合并

## 估时与负责人（Estimate & Owner）
- 估时：1.5d
- 负责人：@待指派
