# Definition of Done（DoD）清单

> 适用于所有 PR；如不适用需在 PR 说明中豁免理由。

## 1. 质量与构建
- [ ] 通过 `pnpm -r lint`、`pnpm -r typecheck`、`pnpm -r test`、`pnpm -r build`
- [ ] 单元测试：新增用例覆盖关键路径；覆盖率不下降（门限：行覆盖 ≥ 80%）
- [ ] E2E/冒烟：小程序（miniprogram-automator）、H5（Playwright）关键路径通过
- [ ] 持续集成：GitHub Actions 全绿

## 2. 性能与包体
- [ ] 微信小程序：首屏 TP90 ≤ 2.5s；主包 < 2MB（分包/按需加载）
- [ ] 编辑器交互：主流机型帧率 ≥ 30fps（轻编辑）
- [ ] 导出 P95：单页 A4/300dpi ≤ 30s（云端）

## 3. 安全与合规
- [ ] 无明文密钥/凭证；环境变量通过 CI Secret 注入
- [ ] 日志脱敏（用户标识、Token、URL 签名）
- [ ] 依赖许可证检查（MIT/Apache/GPL 识别）
- [ ] 第三方素材（字体/贴纸/图片）来源可追溯

## 4. 文档与可运维
- [ ] README 或子包文档更新
- [ ] CHANGELOG 更新（语义化版本）
- [ ] 监控指标接入（PV/导出成功率/导出 P95/错误率）
- [ ] 灰度/回滚预案已验证（脚本或说明）

## 5. 数据与迁移（如涉及）
- [ ] EF 迁移脚本经过本地与 CI 环境验证（可升级/可回滚）
- [ ] 生产数据变更有演练与备份方案
