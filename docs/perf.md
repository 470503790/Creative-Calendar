# 性能优化记录

## 本期优化目标
- 首屏体验：TP90 ≤ 2.5s。
- 体积约束：主包 < 2 MB。
- 交互体验：滚动与图片切换保持流畅，无白屏闪烁。

## 实施项
1. **图片懒加载**
   - 新增 `UiLazyImage` 组件，封装统一的懒加载、骨架占位与错误兜底，应用于首页、模板列表、模板详情、个人中心等涉及首屏与高频滚动的图片场景。
   - 默认渐隐过渡与统一背景可减少加载抖动，覆盖缺省、错误等状态，避免出现空白或闪烁。
2. **按需引入依赖**
   - 首屏页面改为直接按路径引入 UI 组件，避免聚合导出造成的额外打包体积，确保主包保持在 2 MB 预算以内。
3. **首屏打点**
   - `utils/perf.ts` 记录 `App` 启动时间，在首页数据首次返回时标记首屏完成，并透出 `HOME_FIRST_SCREEN_READY` 事件（含首屏耗时、首页状态、模板数量等维度）便于埋点监控。

## 结果对比
- **主包体积**：`du -sh apps/miniapp/unpackage/dist` ≈ 1.1 MB，满足 <2 MB 预算。【89e189†L1-L2】
- **首屏埋点**：日志中可见 `home_first_screen_ready` 事件，包含 `durationMs` 等关键字段，用于后续 TP90 分析。

## 验收建议
- 通过 HBuilderX 真机预览验证首页、模板页滚动与图片加载的流畅度。
- 关注数据平台中新增的 `home_first_screen_ready` 事件，确认首屏耗时监控已上线。
